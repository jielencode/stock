<?xml version="1.0" encoding="UTF-8" ?><!DOCTYPE sqlMap          PUBLIC "-//ibatis.apache.org//DTD SQL Map 2.0//EN"          "http://ibatis.apache.org/dtd/sql-map-2.dtd"><sqlMap namespace="ZcEbEntrust">	<typeAlias alias="ZcEbEntrust" type="com.ufgov.zc.common.zc.model.ZcEbEntrust" />	<typeAlias alias="asVal" type="com.ufgov.zc.common.system.model.AsVal" />	<typeAlias alias="ZcEbEntrustDetail"		type="com.ufgov.zc.common.zc.model.ZcEbEntrustDetail" />	<typeAlias alias="elementCondition"		type="com.ufgov.zc.common.system.dto.ElementConditionDto" />	<resultMap id="ZcEbEntrustResult" class="ZcEbEntrust">		<result property="sn" column="SN" />		<result property="zcMakeCode" column="ZC_MAKE_CODE" />		<result property="zcMakeName" column="ZC_MAKE_NAME" />		<result property="coCode" column="CO_CODE" />		<result property="nd" column="ND" />		<result property="zcMakeLinkman" column="ZC_MAKE_LINKMAN" />		<result property="zcMakeTel" column="ZC_MAKE_TEL" />		<result property="status" column="STATUS" />		<result property="zcInputCode" column="ZC_INPUT_CODE" />		<result property="zcInputDate" column="ZC_INPUT_DATE" />		<result property="zcMoneyBiSum" column="ZC_MONEY_BI_SUM" />		<result property="remark" column="REMARK" />		<result property="processInstId" column="PROCESS_INST_ID" />		<result property="agency" column="AGENCY" />		<result property="zcPifuCgfs" column="ZC_PIFU_CGFS" />		<result property="agencyName" column="AGENCY_NAME" />		<result property="zcDiyuDaima" column="ZC_DIYU_DAIMA" />		<result property="zcWeitoDate" column="ZC_WEITO_DATE" />		<result property="zcIsNotary" column="ZC_IS_NOTARY" />		<result property="zcIsImp" column="ZC_IS_IMP" />		<result property="zcImpFile" column="ZC_IMP_FILE" />		<result property="zcImpFileBlobid" column="ZC_IMP_FILE_BLOBID" />		<result property="untreadReason" column="UNTREAD_REASON" />		<result property="executeDate" column="EXECUTE_DATE" />		<result property="leaderId" column="LEADER_ID" />		<result property="leaderTel" column="LEADER_TEL" />		<result property="orgCode" column="ORG_CODE" />		<result property="snCode" column="SN_CODE" />		<result property="isDesSup" column="IS_DES_SUP" />		<result property="isPub" column="IS_PUB" />		<result property="zcFukuanType" column="ZC_FUKUAN_TYPE" />		<result property="isCar" column="is_car" />	</resultMap>	<resultMap id="ZcEbEntrustResultForProjChange" class="ZcEbEntrust">		<result property="sn" column="SN" />		<result property="zcMakeCode" column="ZC_MAKE_CODE" />		<result property="zcMakeName" column="ZC_MAKE_NAME" />		<result property="coCode" column="CO_CODE" />		<result property="coName" column="co_name" />		<result property="nd" column="ND" />		<result property="zcMakeLinkman" column="ZC_MAKE_LINKMAN" />		<result property="zcMakeTel" column="ZC_MAKE_TEL" />		<result property="status" column="STATUS" />		<result property="zcInputCode" column="ZC_INPUT_CODE" />		<result property="zcInputDate" column="ZC_INPUT_DATE" />		<result property="zcMoneyBiSum" column="ZC_MONEY_BI_SUM" />		<result property="zcMakeSum" column="ZC_MAKE_SUM" />		<result property="remark" column="REMARK" />		<result property="processInstId" column="PROCESS_INST_ID" />		<result property="agency" column="AGENCY" />		<result property="zcPifuCgfs" column="ZC_PIFU_CGFS" />		<result property="agencyName" column="AGENCY_NAME" />		<result property="zcDiyuDaima" column="ZC_DIYU_DAIMA" />		<result property="zcWeitoDate" column="ZC_WEITO_DATE" />		<result property="zcIsNotary" column="ZC_IS_NOTARY" />		<result property="zcIsImp" column="ZC_IS_IMP" />		<result property="zcImpFile" column="ZC_IMP_FILE" />		<result property="zcImpFileBlobid" column="ZC_IMP_FILE_BLOBID" />		<result property="untreadReason" column="UNTREAD_REASON" />		<result property="executeDate" column="EXECUTE_DATE" />		<result property="leaderId" column="LEADER_ID" />		<result property="leaderTel" column="LEADER_TEL" />		<result property="orgCode" column="ORG_CODE" />	</resultMap>	<resultMap id="ZcEbEntrustDetail" class="ZcEbEntrustDetail">		<result property="snd" column="SND" />		<result property="sn" column="SN" />		<result property="zcYear" column="ZC_YEAR" />		<result property="zcCatalogueCode" column="ZC_CATALOGUE_CODE" />		<result property="zcCatalogueName" column="ZC_CATALOGUE_NAME" />		<result property="zcPitemName" column="ZC_PITEM_NAME" />		<result property="zcPitemArrDate" column="ZC_PITEM_ARR_DATE" />		<result property="zcBaseGgyq" column="ZC_BASE_GGYQ" />		<result property="zcPitemAttach" column="ZC_PITEM_ATTACH" />		<result property="zcPitemAttachBlobid" column="ZC_PITEM_ATTACH_BLOBID" />		<result property="zcCaigNum" column="ZC_CAIG_NUM" />		<result property="zcCaigUnit" column="ZC_CAIG_UNIT" />		<result property="zcItemSum" column="ZC_ITEM_SUM" />		<result property="zcMerPrice" column="ZC_MER_PRICE" />		<result property="budgetBiMoney" column="BUDGET_BI_MONEY" />		<result property="budgetOtherMoney" column="BUDGET_OTHER_MONEY" />	</resultMap>	<select id="getZcEbEntrustChanging" resultMap="ZcEbEntrustResult"		parameterClass="elementCondition">		select * from zc_eb_entrust t		<dynamic prepend="where">			<isNotNull prepend="and" property="coCodeFilter">				t.CO_CODE =				#coCodeFilter#			</isNotNull>		</dynamic>	</select>	<resultMap id="valOrg" class="asVal">		<result property="valId" column="org_code" />		<result property="val" column="org_name" />	</resultMap>	<select id="getRoleId" resultMap="valOrg" parameterClass="elementCondition">		select		aer.role_id ORG_CODE,au.user_id ORG_NAME		from as_user au ,as_emp_role		aer		where aer.emp_code=au.user_code		and au.user_id=#dattr1:VARCHAR#	</select>	<select id="getValOrg" resultMap="valOrg" parameterClass="elementCondition">		select		org.ORG_CODE, org.ORG_NAME		from as_org org		where org.ORG_CODE in		(select		CODE		from V_SYS_RULE_COMPO_DETAIL		where right_group_describe = '001'		and		rule_id in (select r.rule_id		from sys_user_role_rule r)		and compo_id =		'*'		and func_id = 'fwatch'		and ctrl_field = 'ORG_CODE')		AND		org.ORG_CODE!='902'	</select>	<select id="getZcEbEntrust" resultMap="ZcEbEntrustResult"		parameterClass="elementCondition">		select		*		from		zc_eb_entrust master		where		1=1		<isNotEqual prepend="AND" compareValue="0" property="nd">			master.ND=#nd:INTEGER#		</isNotEqual>		<include refid="BusiNumLim.BusiNumLimStr" />		<isNotNull prepend="AND" property="status">			<isEqual property="status" compareValue="accepted">				(master.status ='2' )			</isEqual>			<isEqual property="status" compareValue="unaccepted">				(master.status ='3')			</isEqual>			<isEqual property="status" compareValue="waitingaccepted">				(master.status ='1')			</isEqual>			<isEqual property="status" compareValue="send">				(master.status ='0')			</isEqual>			<isEqual property="status" compareValue="draft">				(master.status				='draft')			</isEqual>			<isEqual property="status" compareValue="cancel">				(master.status='cancel')			</isEqual>		</isNotNull>		<isNotNull prepend="and" property="coCode">			master.CO_CODE=#coCode:VARCHAR#		</isNotNull>		order by ZC_INPUT_DATE desc	</select>	<select id="getZcEbEntrustWithFN" resultMap="ZcEbEntrustResult"		parameterClass="elementCondition">		select * from zc_eb_entrust master		<isNotNull prepend="where" property="billStatus">			master.status			=#billStatus:VARCHAR#		</isNotNull>	</select>	<select id="getCountData" resultClass="int" parameterClass="string">		select count(*) from zc_eb_entrust where sn = #sn#	</select>	<select id="getZcEbEntrustWithPiBan" resultMap="ZcEbEntrustResultForProjChange"		parameterClass="elementCondition">		SELECT E.SN,		E.ZC_MAKE_CODE,		E.ZC_MAKE_NAME,		E.CO_CODE,		E.ND,		D.SUPERINTENDENT_NAME ZC_MAKE_LINKMAN,		E.ZC_MAKE_TEL,		E.STATUS,		E.ZC_INPUT_CODE,		E.ZC_INPUT_DATE,		MAKE.PROJ_SUM ZC_MAKE_SUM,		E.		ZC_MONEY_BI_SUM ZC_MONEY_BI_SUM,		E.REMARK,		E.PROCESS_INST_ID,		E.AGENCY,		MAKE.Pur_Type ZC_PIFU_CGFS,		E.AGENCY_NAME,		E.ZC_DIYU_DAIMA,		E.ZC_WEITO_DATE,		E.ZC_IS_NOTARY,		E.ZC_IS_IMP,		E.ZC_IMP_FILE,		E.ZC_IMP_FILE_BLOBID,		E.UNTREAD_REASON,		E.EXECUTE_DATE,		E.LEADER_ID,		E.LEADER_TEL,		E.ORG_CODE		FROM ZC_EB_ENTRUST E,		ZC_EB_DUTY_AUDIT_SHEET D,		V_ZC_P_PRO_MAKE MAKE,		(SELECT MAX(T.EXECUTE_TIME) D, T.INSTANCE_ID INS		FROM WF_ACTION_HISTORY T		WHERE T.INSTANCE_ID IN		(SELECT		S.PROCESS_INST_ID FROM ZC_EB_DUTY_AUDIT_SHEET S)		GROUP BY		T.INSTANCE_ID) WH		WHERE E.SN = D.SN		AND MAKE.PROJ_CODE = E.Zc_Make_Code		AND WH.INS = D.PROCESS_INST_ID		AND D.STATUS = 'exec'		<isNotNull prepend="and" property="zcText0">			e.zc_pifu_cgfs!=#zcText0#		</isNotNull>		<isNotNull prepend="and" property="executor">			d.Superintendent=#executor#		</isNotNull>		<isNotNull prepend="and" property="coCode">			e.AGENCY=#coCode#		</isNotNull>		<include refid="BusiNumLim.BusiNumLimStr" />		ORDER BY WH.D DESC	</select><select id="getZcEbEntrustWithPiBan2" resultMap="ZcEbEntrustResultForProjChange"		parameterClass="elementCondition">SELECT E.SN,       E.ZC_MAKE_CODE,       E.ZC_MAKE_NAME,       E.CO_CODE,       m.co_name,       E.ND,       d.SUPERINTENDENT_NAME ZC_MAKE_LINKMAN,       E.ZC_MAKE_TEL,       E.STATUS,       E.ZC_INPUT_CODE,       E.ZC_INPUT_DATE,       vm.PROJ_SUM - nvl(vp.usedBudget, 0) as ZC_MAKE_SUM,       E.ZC_MONEY_BI_SUM ZC_MONEY_BI_SUM,       E.REMARK,       E.PROCESS_INST_ID,       E.AGENCY,       e.zc_pifu_cgfs,       E.AGENCY_NAME,       E.ZC_DIYU_DAIMA,       E.ZC_WEITO_DATE,       E.ZC_IS_NOTARY,       E.ZC_IS_IMP,       E.ZC_IMP_FILE,       E.ZC_IMP_FILE_BLOBID,       E.UNTREAD_REASON,       E.EXECUTE_DATE,       E.LEADER_ID,       E.LEADER_TEL,       E.ORG_CODE  from ZC_EB_ENTRUST E, ZC_EB_DUTY_AUDIT_SHEET D,ma_company m, v_zc_p_pro_make vm  left join (select vp.zc_make_code, sum(vp.pack_budget) as usedBudget               from v_zc_normal_pack vp              group by vp.zc_make_code) vp    on (vm.PROJ_CODE = vp.ZC_MAKE_CODE) where e.sn = d.sn   and e.zc_make_code = vm.PROJ_CODE   and not exists (select vv.zc_make_code, vv.usedBudget          from (select vp.zc_make_code, sum(vp.pack_budget) as usedBudget                  from v_zc_normal_pack vp                 group by vp.zc_make_code) vv         where vm.PROJ_CODE = vv.zc_make_code           and vm.PROJ_SUM = vv.usedBudget)   and d.status = 'exec'   and e.nd=m.nd   and e.co_code=m.co_code		<isNotNull prepend="and" property="executor">			d.Superintendent=#executor#		</isNotNull>		<isNotNull prepend="and" property="coCode">			e.AGENCY=#coCode#		</isNotNull>		<include refid="BusiNumLim.BusiNumLimStr" />  </select>	<!-- 委托协议 -->	<select id="getZcEbEntrustWithPiBanProtocol" resultMap="ZcEbEntrustResult"		parameterClass="elementCondition">		select		SN,		ZC_MAKE_CODE,		ZC_MAKE_NAME,		CO_CODE,		ND,		ZC_MAKE_LINKMAN,		ZC_MAKE_TEL,		STATUS,		ZC_INPUT_CODE,		ZC_INPUT_DATE,		ZC_MONEY_BI_SUM,		REMARK,		PROCESS_INST_ID,		AGENCY,		ZC_PIFU_CGFS,		AGENCY_NAME,		ZC_DIYU_DAIMA,		ZC_WEITO_DATE,		ZC_IS_NOTARY,		ZC_IS_IMP,		ZC_IMP_FILE,		ZC_IMP_FILE_BLOBID,		UNTREAD_REASON,		EXECUTE_DATE,		LEADER_ID,		LEADER_TEL,		ORG_CODE,IS_DES_SUP,IS_PUB,is_car,ZC_FUKUAN_TYPE		from (		SELECT E.SN,		E.ZC_MAKE_CODE,		E.ZC_MAKE_NAME,		E.CO_CODE,		E.ND,		ZC_EB_DUTY_AUDIT_SHEET.SUPERINTENDENT_NAME ZC_MAKE_LINKMAN,		E.ZC_MAKE_TEL,		E.STATUS,		E.ZC_INPUT_CODE,		E.ZC_INPUT_DATE,		E.ZC_MONEY_BI_SUM,		E.REMARK,		E.PROCESS_INST_ID,		E.AGENCY AGENCY,		E.ZC_PIFU_CGFS,		E.AGENCY_NAME,		E.ZC_DIYU_DAIMA,		E.ZC_WEITO_DATE,		E.ZC_IS_NOTARY,		E.ZC_IS_IMP,		E.ZC_IMP_FILE,		E.ZC_IMP_FILE_BLOBID,		E.UNTREAD_REASON,		E.EXECUTE_DATE,		E.LEADER_ID,		E.LEADER_TEL,		E.ORG_CODE,E.IS_DES_SUP,E.IS_PUB,E.is_car,E.ZC_FUKUAN_TYPE,		WH.D EXECUTE_TIME		FROM ZC_EB_ENTRUST		E,		ZC_EB_DUTY_AUDIT_SHEET		ZC_EB_DUTY_AUDIT_SHEET,		(SELECT		MAX(T.EXECUTE_TIME) D, T.INSTANCE_ID INS		FROM WF_ACTION_HISTORY		T		WHERE		T.INSTANCE_ID IN		(SELECT S.PROCESS_INST_ID		FROM		ZC_EB_DUTY_AUDIT_SHEET		S)		GROUP BY T.INSTANCE_ID) WH		WHERE E.SN =		ZC_EB_DUTY_AUDIT_SHEET.SN		AND		WH.INS =		ZC_EB_DUTY_AUDIT_SHEET.PROCESS_INST_ID		AND		ZC_EB_DUTY_AUDIT_SHEET.STATUS = 'exec'		AND e.sn NOT IN		(SELECT		protocol.sn FROM		zc_eb_protocol protocol)		<isNotNull prepend="and" property="zcText0">			e.zc_pifu_cgfs!=#zcText0#		</isNotNull>		<isNotNull prepend="and" property="executor">			ZC_EB_DUTY_AUDIT_SHEET.Superintendent=#executor#		</isNotNull>		<isNotNull prepend="and" property="coCode">			e.AGENCY=#coCode#		</isNotNull>		)where 1=1		<include refid="BusiNumLim.BusiNumLimStr" />		ORDER BY EXECUTE_TIME DESC	</select>	<!-- 采购需求 -->	<select id="getZcEbEntrustWithPiBanRequirment" resultMap="ZcEbEntrustResult"		parameterClass="elementCondition">		SELECT E.SN,		E.ZC_MAKE_CODE,		E.ZC_MAKE_NAME,		E.CO_CODE,		E.ND,		D.SUPERINTENDENT_NAME ZC_MAKE_LINKMAN,		E.ZC_MAKE_TEL,		E.STATUS,		E.ZC_INPUT_CODE,		E.ZC_INPUT_DATE,		E.ZC_MONEY_BI_SUM,		E.REMARK,		E.PROCESS_INST_ID,		E.AGENCY,		E.ZC_PIFU_CGFS,		E.AGENCY_NAME,		E.ZC_DIYU_DAIMA,		E.ZC_WEITO_DATE,		E.ZC_IS_NOTARY,		E.ZC_IS_IMP,		E.ZC_IMP_FILE,		E.ZC_IMP_FILE_BLOBID,		E.UNTREAD_REASON,		E.EXECUTE_DATE,		E.LEADER_ID,		E.LEADER_TEL,		E.ORG_CODE,e.IS_DES_SUP,E.IS_PUB,E.is_car,E.ZC_FUKUAN_TYPE		FROM		ZC_EB_ENTRUST E,		ZC_EB_DUTY_AUDIT_SHEET D,		(SELECT		MAX(T.EXECUTE_TIME) D,		T.INSTANCE_ID		INS		FROM WF_ACTION_HISTORY T		WHERE		T.INSTANCE_ID IN		(SELECT		S.PROCESS_INST_ID FROM ZC_EB_DUTY_AUDIT_SHEET		S)		GROUP BY T.INSTANCE_ID)		WH		WHERE E.SN = D.SN		AND WH.INS =		D.PROCESS_INST_ID		AND D.STATUS = 'exec'		AND e.sn NOT IN		(SELECT		protocol.sn FROM		zc_eb_protocol protocol)		AND e.sn		NOT IN (SELECT req.sn		FROM zc_eb_requirement req)		<isNotNull prepend="and" property="zcText0">			e.zc_pifu_cgfs!=#zcText0#		</isNotNull>		<isNotNull prepend="and" property="executor">			d.Superintendent=#executor#		</isNotNull>		<isNotNull prepend="and" property="coCode">			e.AGENCY=#coCode#		</isNotNull>		<include refid="BusiNumLim.BusiNumLimStr" />		ORDER BY WH.D DESC	</select>	<select id="getZcEbEntrustDetailBySn" resultMap="ZcEbEntrustDetail"		parameterClass="string">		select * from zc_eb_entrust_detail where sn=#value#		order by SND	</select>	<select id="getZcEbEntrustDetail" resultMap="ZcEbEntrustDetail"		parameterClass="elementCondition">		select * from zc_eb_entrust_detail ed where sn=#zcText0#		and not exists		(select snd from zc_eb_requirement_detail where snd=ed.snd and		sn=ed.sn		<isNotNull prepend="and" property="zcText2">			req_code!=#zcText2#		</isNotNull>		)		and snd not in ($zcText3$)		order by SND	</select>	<select id="getZcEbEntrustByMakeCode" resultMap="ZcEbEntrustResult"		parameterClass="string">		select * from zc_eb_entrust where zc_make_code=#value#	</select>	<select id="getZcEbEntrustBySn" resultMap="ZcEbEntrustResult"		parameterClass="string">		select * from zc_eb_entrust where sn=#value#	</select>	<select id="getZcEbEntrustBySnCode" resultMap="ZcEbEntrustResult"		parameterClass="string">		select * from zc_eb_entrust where sn_code=#value#	</select>	<select id="getZcEbEntrustByProjCode" resultMap="ZcEbEntrustResult"		parameterClass="string">		select zt.*		from zc_eb_entrust zt, zc_eb_pack pack		where pack.entrust_code = zt.sn		and pack.proj_code = #value#	    and rownum=1	</select>	<select id="getZcEbEntrustDetailBySnWithFN" resultMap="ZcEbEntrustDetail"		parameterClass="elementCondition">		select * from zc_eb_entrust_detail where SN=#zcText0#		order by SND	</select>	<update id="updateZcEbEntrustStatus" parameterClass="ZcEbEntrust">		update		zc_eb_entrust set status=#status:VARCHAR#,		PROCESS_INST_ID=#processInstId#,		EXECUTE_DATE=#executeDate:DATE#		where		sn=#sn:VARCHAR#	</update>	<update id="updateZcEbEntrust" parameterClass="ZcEbEntrust">		update		ZC_EB_ENTRUST		set		SN=#sn:VARCHAR#,		ZC_MAKE_CODE=#zcMakeCode:VARCHAR#,		ZC_MAKE_NAME=#zcMakeName:VARCHAR#,		CO_CODE=#coCode:VARCHAR#,		ND=#nd:VARCHAR#,		ZC_MAKE_LINKMAN=#zcMakeLinkman:VARCHAR#,		ZC_MAKE_TEL=#zcMakeTel:VARCHAR#,		STATUS=#status:VARCHAR#,		ZC_INPUT_CODE=#zcInputCode:VARCHAR#,		ZC_INPUT_DATE=#zcInputDate:DATE#,		ZC_MONEY_BI_SUM=#zcMoneyBiSum:DECIMAL#,		REMARK=#remark:VARCHAR#,		AGENCY=#agency:VARCHAR#,		ZC_PIFU_CGFS=#zcPifuCgfs:VARCHAR#,		AGENCY_NAME=#agencyName:VARCHAR#,		ZC_DIYU_DAIMA=#zcDiyuDaima:VARCHAR#,		ZC_WEITO_DATE=#zcWeitoDate:DATE#,		ZC_IS_NOTARY=#zcIsNotary:VARCHAR#,		ZC_IS_IMP=#zcIsImp:VARCHAR#,		ZC_IMP_FILE=#zcImpFile:VARCHAR#,		ZC_IMP_FILE_BLOBID=#zcImpFileBlobid:VARCHAR#,		UNTREAD_REASON=#untreadReason:VARCHAR#,		EXECUTE_DATE=#executeDate:DATE#,		LEADER_ID=#leaderId:VARCHAR#,		LEADER_TEL=#leaderTel:VARCHAR#,		ORG_CODE=#orgCode:VARCHAR#,		SN_CODE=#snCode:VARCHAR#,		IS_DES_SUP=#isDesSup:VARCHAR#,		IS_PUB=#isPub:VARCHAR#,		is_car=#isCar:VARCHAR#,		ZC_FUKUAN_TYPE=#zcFukuanType:VARCHAR#		where		SN=#sn:VARCHAR#	</update>	<delete id="deleteByMakeCode" parameterClass="string">		delete from		ZC_EB_ENTRUST where ZC_MAKE_CODE = #value#	</delete>	<delete id="deleteBySn" parameterClass="string">		delete from		ZC_EB_ENTRUST where sn = #value#	</delete>	<select id="getOriginZcEbEntrustByIdList" resultMap="ZcEbEntrustResult"		parameterClass="Map">		select * from zc_eb_entrust master		<dynamic prepend="WHERE">			<iterate prepend="AND" property="idList" open="(" close=")"				conjunction="OR">				sn=#idList[]#			</iterate>		</dynamic>		for update	</select>	<select id="getZcEbEntrustDetailList" resultMap="ZcEbEntrustDetail"		parameterClass="Map">		select * from zc_eb_entrust_detail master		<dynamic prepend="WHERE">			<iterate prepend="AND" property="idList" open="(" close=")"				conjunction="OR">				sn=#idList[]#			</iterate>		</dynamic>	</select>	<select id="fkList" resultMap="ZcEbEntrustResult"		parameterClass="elementCondition">		SELECT *		FROM ZC_EB_ENTRUST F		ORDER BY F.ZC_INPUT_DATE		DESC	</select>	<select id="getEntrutsList" resultMap="ZcEbEntrustResult"		parameterClass="elementCondition">		SELECT F.*		FROM ZC_EB_ENTRUST F,		(select zerp.entrust_code,		sum(case zerp.bid_sum		when 0 then case zerp.status when '5' then 0 else zerp.pack_budget end		else zerp.bid_sum		end) budget		from zc_eb_req_pack zerp		where zerp.status != 'cancel'		group by zerp.entrust_code) pack		where F.Status='2'		and F.Co_Code=#coCode#		and f.sn=pack.entrust_code(+)		and (pack.budget is null or f.zc_money_bi_sum>pack.budget)		 and exists (select sheet.sn            from zc_eb_duty_audit_sheet sheet           where sheet.sn = f.sn             and sheet.superintendent is not null          )		ORDER BY		F.ZC_INPUT_DATE DESC	</select>	<select id="queryBySN" resultMap="ZcEbEntrustDetail"		parameterClass="map">		select * from zc_eb_entrust_detail where sn = #SN#	</select>	<insert id="insertZcEbEntrust" parameterClass="ZcEbEntrust">		insert into		zc_eb_entrust		(sn,		zc_make_code,		zc_make_name,		CO_CODE,		ND,		zc_make_linkman,		zc_make_tel,		status,		zc_input_code,		zc_input_date,		zc_money_bi_sum,		remark,		process_inst_id,		AGENCY,		zc_pifu_cgfs,		AGENCY_NAME,		zc_diyu_daima,		zc_weito_date,		zc_is_notary,		zc_is_imp,		zc_imp_file,		zc_imp_file_blobid,		untread_reason,		leader_id,		leader_tel,		ORG_CODE,IS_DES_SUP,IS_PUB,is_car,ZC_FUKUAN_TYPE,		EXECUTE_DATE)		values		(#sn:VARCHAR#,		#zcMakeCode:VARCHAR#,		#zcMakeName:VARCHAR#,		#coCode:VARCHAR#,		#nd:VARCHAR#,		#zcMakeLinkman:VARCHAR#,		#zcMakeTel:VARCHAR#,		#status:VARCHAR#,		#zcInputCode:VARCHAR#,		#zcInputDate:DATE#,		#zcMoneyBiSum:DECIMAL#,		#remark:VARCHAR#,		#processInstId:DECIMAL#,		#agency:VARCHAR#,		#zcPifuCgfs:VARCHAR#,		(select		zc_b_agency.zc_agey_name		from ZC_B_AGENCY		zc_b_agency where		zc_b_agency.zc_agey_code=#agency:VARCHAR#),		#zcDiyuDaima:VARCHAR#,		#zcWeitoDate:DATE#,		#zcIsNotary:VARCHAR#,		#zcIsImp:VARCHAR#,		#zcImpFile:VARCHAR#,		#zcImpFileBlobid:VARCHAR#,		#untreadReason:VARCHAR#,		#leaderId:VARCHAR#,		#leaderTel:VARCHAR#,		#orgCode:VARCHAR#,#isDesSup:VARCHAR#,#isPub:VARCHAR#,#isCar:VARCHAR#,#zcFukuanType:VARCHAR#,		#executeDate#)	</insert>	<insert id="insertZcEbEntrustDetail" parameterClass="ZcEbEntrustDetail">		insert into		zc_eb_entrust_detail		(snd,		sn,		zc_year,		zc_catalogue_code,		zc_catalogue_name,		zc_pitem_name,		zc_pitem_arr_date,		zc_base_ggyq,		zc_pitem_attach,		zc_pitem_attach_blobid,		zc_caig_num,		zc_caig_unit,		zc_item_sum,		zc_mer_price,		budget_bi_money,		budget_other_money)		values(		#snd:VARCHAR#,		#sn:VARCHAR#,		#zcYear:VARCHAR#,		#zcCatalogueCode:VARCHAR#,		#zcCatalogueName:VARCHAR#,		#zcPitemName:VARCHAR#,		#zcPitemArrDate:DATE#,		#zcBaseGgyq:VARCHAR#,		#zcPitemAttach:VARCHAR#,		#zcPitemAttachBlobid:VARCHAR#,		#zcCaigNum:DECIMAL#,		#zcCaigUnit:VARCHAR#,		#zcItemSum:DECIMAL#,		#zcMerPrice:DECIMAL#,		#budgetBiMoney:DECIMAL#,		#budgetOtherMoney:DECIMAL#		)	</insert>	<delete id="deleteZcEbEntrustDetail" parameterClass="String">		delete from		zc_eb_entrust_detail where sn=#value#	</delete>	<delete id="deleteZcEbEntrustDetaiBi" parameterClass="String">		delete from		<!-- 任务单的资金构成信息保存到ZC_P_PRO_MITEM_BI表中 -->		ZC_P_PRO_MITEM_BI where zc_make_code=#value#	</delete>	<delete id="deleteByPrimaryKey" parameterClass="String">		delete from		zc_eb_entrust where sn=#value#	</delete>	<delete id="deleteZcEbEntrustDetailById" parameterClass="String">		delete		from zc_eb_entrust_detail where snd=#value#	</delete>	<select id="getZcEbEntrustWithPiBan4Requirement" resultMap="ZcEbEntrustResult"		parameterClass="elementCondition">		select e.* from zc_eb_entrust e, zc_eb_duty_audit_sheet		d,ZC_EB_REQUIREMENT req		where e.sn=d.sn		and d.status='exec'		and e.sn =		req.sn(+)		and req.sn is null		<isNotNull prepend="and" property="zcText0">			e.zc_pifu_cgfs!=#zcText0#		</isNotNull>		<include refid="BusiNumLim.BusiNumLimStr" />		order by e.zc_input_date desc	</select>	<select id="getEntrustForNotepad" resultMap="ZcEbEntrustResult"		parameterClass="elementCondition">		SELECT e.*		FROM ZC_EB_ENTRUST E,zc_eb_duty_audit_sheet sh		where		e.sn =		sh.sn		<isNotNull prepend="and" property="userId">			sh.superintendent =			#userId#		</isNotNull>		<isNotNull prepend="and" property="zcText0">			sh.sn = #zcText0#		</isNotNull>		order by e.zc_input_code desc	</select>	<select id="getZcEbEntrustCondition" resultMap="ZcEbEntrustResult"		parameterClass="elementCondition">		select * from		zc_eb_entrust m, zc_eb_duty_audit_sheet s		where m.sn=s.sn		<isNotEqual prepend="AND" compareValue="0" property="nd">			m.ND=#nd:INTEGER#		</isNotEqual>		<isNotNull prepend="AND" property="orgCode">			s.SUPERINTENDENT_ORG=#orgCode#		</isNotNull>	</select></sqlMap>