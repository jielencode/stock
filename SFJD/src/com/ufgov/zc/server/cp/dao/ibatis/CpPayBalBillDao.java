package com.ufgov.zc.server.cp.dao.ibatis;import java.util.HashMap;import java.util.List;import java.util.Map;import org.springframework.orm.ibatis.support.SqlMapClientDaoSupport;import com.ufgov.zc.common.cp.model.CpPayBalBill;import com.ufgov.zc.common.cp.model.CpPayBalList;import com.ufgov.zc.common.cp.model.CpPayBalRelation;import com.ufgov.zc.common.system.constants.NumLimConstants;import com.ufgov.zc.common.system.dto.ElementConditionDto;import com.ufgov.zc.server.cp.dao.ICpPayBalBillDao;import com.ufgov.zc.server.system.util.NumLimUtil;import com.ufgov.zc.server.system.util.Util;public class CpPayBalBillDao extends SqlMapClientDaoSupport implements ICpPayBalBillDao {  public List getCpPayBalBill(ElementConditionDto dto) {//    dto.setNumLimitStr(NumLimUtil.getInstance().getNumLimCondByCoType(dto.getNumLimCompoId(),////    NumLimConstants.FWATCH));    List list = this.getSqlMapClientTemplate().queryForList("CpPayBalBill.getCpPayBalBill", dto);    List cpPayBalList = this.getSqlMapClientTemplate().queryForList("CpPayBalBill.getCpPayBalList", dto);    Map cpPayBalListMap = Util.createKeyListMap("payBalBillId", cpPayBalList);    List cpPayBalRelation = this.getSqlMapClientTemplate().queryForList("CpPayBalBill.getCpPayBalRelation", dto);    Map cpPayBalRelationMap = Util.createKeyListMap("payBalBillId", cpPayBalRelation);    for (int i = 0; i < list.size(); i++) {      CpPayBalBill bill = (CpPayBalBill) list.get(i);      List tempList1 = (List) cpPayBalListMap.get(bill.getPayBalBillId());      List tempList2 = (List) cpPayBalRelationMap.get(bill.getPayBalBillId());      if (tempList1 != null) {        bill.setCpPayBalLists(tempList1);      }      if (tempList2 != null) {        bill.setCpPayBalRelations(tempList2);      }    }    return list;  }  public int updateCpvoucherByPayBalBillId(CpPayBalBill bill) {    Map params = new HashMap();    params.put("payBalBillId", bill.getPayBalBillId());    String vouNoListStr = bill.getPayVouNoList();    String[] buffer = vouNoListStr.split(",");    String temp = "";    for (int i = 0; i < buffer.length; i++) {      temp += "," + "'" + buffer[i] + "'";    }    temp = temp.substring(1);    params.put("payVouNoList", temp);    return this.getSqlMapClientTemplate().update("CpPayBalBill.updateCpvoucherByPayBalBillId", params);  }  public int updateCpvoucherByPayBalBillIdForDel(CpPayBalBill bill) {    Map params = new HashMap();    params.put("payBalBillId", bill.getPayBalBillId());    return this.getSqlMapClientTemplate().update("CpPayBalBill.updateCpvoucherByPayBalBillIdForDel", params);  }  public void insertCpPayBalBill(CpPayBalBill bill) {    this.getSqlMapClientTemplate().insert("CpPayBalBill.insertCpPayBalBill", bill);  }  public void insertCpPayBalList(CpPayBalList balList) {    this.getSqlMapClientTemplate().insert("CpPayBalBill.insertCpPayBalList", balList);  }  public void insertCpPayBalRelation(CpPayBalRelation balRelation) {    this.getSqlMapClientTemplate().insert("CpPayBalBill.insertCpPayBalRelation", balRelation);  }  public void deleteCpPayBalBill(CpPayBalBill bill) {    this.getSqlMapClientTemplate().delete("CpPayBalBill.deleteCpPayBalBill", bill);  }  public void deleteCpPayBalListByBalBill(CpPayBalBill bill) {    this.getSqlMapClientTemplate().delete("CpPayBalBill.deleteCpPayBalListByBalBill", bill);  }  public void deleteCpPayRelationByBalBill(CpPayBalBill bill) {    this.getSqlMapClientTemplate().delete("CpPayBalBill.deleteCpPayRelationByBalBill", bill);  }  public void updateCpPayBalBillStatus(Map params) {    this.getSqlMapClientTemplate().update("CpPayBalBill.updateCpPayBalBillAstatus", params);  }  public void updateCpPayBalBillPrintTimes(String ids) {    this.getSqlMapClientTemplate().update("CpPayBalBill.updateCpPayBalBillPrintTimes", ids);  }}