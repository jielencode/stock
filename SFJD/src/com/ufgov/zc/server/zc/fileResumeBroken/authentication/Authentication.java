package com.ufgov.zc.server.zc.fileResumeBroken.authentication;import java.util.HashMap;import java.util.Map;public class Authentication {  private Map parameterMap = new HashMap();  private Map returnMap = new HashMap();  private String functionDo;  private boolean ifNext = false;  public boolean isIfNext() {    return ifNext;  }  public void setIfNext(boolean ifNext) {    this.ifNext = ifNext;  }  public Map getParameterMap() {    return parameterMap;  }  public void setParameterMap(Map parameterMap) {    this.parameterMap = parameterMap;  }  public Map getReturnMap() {    return returnMap;  }  public void setReturnMap(Map returnMap) {    this.returnMap = returnMap;  }  public String getFunctionDo() {    return functionDo;  }  public void setFunctionDo(String functionDo) {    this.functionDo = functionDo;  }  public Authentication(Map parameterMap, String functionDo) {    setParameterMap(parameterMap);    setFunctionDo(functionDo);  }  public void start() {    System.out.println("------------verifyUser start-----------");    verifyUser();//验证用户ID与密码    System.out.println("------------verifyUser end-----------");    //若用户ID与密码正确，验证该项目是否已报名    System.out.println("------------Authentication00002-----------");    if (isIfNext()) {      System.out.println("------------verifyProjectRegistration start-----------");      verifyProjectRegistration();    }    //若该项目已报名，验证是否已超招标截止日期    System.out.println("------------verifyProjectRegistration end-----------");    if (isIfNext()) {      System.out.println("------------verifyProjectBidEndTime start-----------");      verifyProjectBidEndTime();    }    System.out.println("------------verifyProjectBidEndTime end-----------");    //若未超招标截止日期，验证是否已上传过该文件    if (isIfNext()) {      if ("COMMON".equalsIgnoreCase((String) parameterMap.get("UPLOADMOLD"))) {        verifyBidFileExist();      }    }  }  /**   * 验证帐户与密码   */  public void verifyUser() {    if ((String) parameterMap.get("VERIFYID") == null) {      returnMap.put("USERPASS", "false");      returnMap.put("FAILREASON", "客户端缺少参数VERIFYID，请检查客户端版本！");      setIfNext(false);      return;    } else if ("NOID".equalsIgnoreCase((String) parameterMap.get("VERIFYID"))) {      if ((String) parameterMap.get("USERID") == null) {        returnMap.put("USERPASS", "false");        returnMap.put("FAILREASON", "客户端缺少参数USERID，请检查客户端版本！");        setIfNext(false);        return;      }    }    UserVerify userVerify = new UserVerify((String) parameterMap.get("USERID"), (String) parameterMap.get("PASSWORD"), (String) parameterMap    .get("VERIFYID"));    userVerify.setUserType((String) parameterMap.get("USERTYPE"));    userVerify.startVerify();    if (userVerify.isIfPass()) {      returnMap.put("USERPASS", "true");      returnMap.put("PROVIDERID", userVerify.getProviderId());      returnMap.put("PROVIDERNAME", userVerify.getProviderName());      returnMap.put("USERID", userVerify.getUserId());      parameterMap.put("PROVIDERID", userVerify.getProviderId());      parameterMap.put("PROVIDERNAME", userVerify.getProviderName());      parameterMap.put("USERID", userVerify.getUserId());      if (parameterMap.get("PROVIDERID") == null || "".equals(parameterMap.get("PROVIDERID"))) {        parameterMap.put("PROVIDERID", (String) parameterMap.get("USERID"));      }      setIfNext(true);    } else {      returnMap.put("USERPASS", "false");      returnMap.put("FAILREASON", userVerify.getFailReason());      setIfNext(false);    }  }  /**   * 验证项目是否已报名   */  public void verifyProjectRegistration() {    if ((String) parameterMap.get("PROJECTCODE") == null) {      returnMap.put("USERPASS", "false");      returnMap.put("FAILREASON", "客户端缺少参数PROJECTCODE，请检查客户端版本！");      setIfNext(false);      return;    }    if ((String) parameterMap.get("PACKCODE") == null) {      returnMap.put("USERPASS", "false");      returnMap.put("FAILREASON", "客户端缺少参数PACKCODE，请检查客户端版本！");      setIfNext(false);      return;    }    if ((String) parameterMap.get("USERID") == null) {      returnMap.put("USERPASS", "false");      returnMap.put("FAILREASON", "客户端缺少参数USERID，请检查客户端版本！");      setIfNext(false);      return;    }    ProjectRegistrationVerify projectRegistrationVerify = new ProjectRegistrationVerify((String) parameterMap.get("PROJECTCODE"),    (String) parameterMap.get("USERID"), (String) parameterMap.get("PACKCODE"));    projectRegistrationVerify.start();    if (projectRegistrationVerify.isIfPass()) {      returnMap.put("USERPASS", "true");      setIfNext(true);    } else {      returnMap.put("USERPASS", "false");      returnMap.put("FAILREASON", projectRegistrationVerify.getFailReason());      setIfNext(false);    }  }  /**   * 验证该项目是 否已超投标截止时间   */  public void verifyProjectBidEndTime() {    if ((String) parameterMap.get("PROJECTCODE") == null) {      returnMap.put("USERPASS", "false");      returnMap.put("FAILREASON", "客户端缺少参数PROJECTCODE，请检查客户端版本！");      setIfNext(false);      return;    }    ProjectBidEndTimeVerify projectBidEndTimeVerify = new ProjectBidEndTimeVerify((String) parameterMap.get("PROJECTCODE"));    projectBidEndTimeVerify.startVerify();    if (projectBidEndTimeVerify.isIfPass()) {      returnMap.put("USERPASS", "true");      setIfNext(true);    } else {      returnMap.put("USERPASS", "false");      returnMap.put("FAILREASON", projectBidEndTimeVerify.getFailReason());      setIfNext(false);    }  }  /**   * 验证文件是否已上传过   */  public void verifyBidFileExist() {    BidFileExistVerify bidFileExistVerify = new BidFileExistVerify(parameterMap);    bidFileExistVerify.startVerify();    returnMap.putAll(bidFileExistVerify.getReturnMap());    returnMap.put("SERVERFILELEN", String.valueOf(bidFileExistVerify.getFileLen()));    returnMap.put("SERVERFILEPATH", bidFileExistVerify.getServerFilePath());    returnMap.put("SERVERFILEUPLOADSPATH", System.getProperty("user.dir") + "/fileUploads/");  }}