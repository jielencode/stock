package com.ufgov.zc.common.zc.pagination.style;import java.util.Iterator;import java.util.Set;import com.ufgov.zc.common.zc.pagination.PaginationStyle;import com.ufgov.zc.common.zc.pagination.WebPagination;/** *  * <p> * Title: * </p> * <p> * Description: * </p> * <p> * Copyright: Copyright (c) 2007 * </p> * <p> * Company: MiracleSoft * </p> *  * @author 林文雄 * @version 1.0 */public class DefaultStyle implements PaginationStyle {  public String getPaginationString(WebPagination webPagination) {    StringBuffer info = new StringBuffer("<TABLE border='0' class=\"pageTable\"><TR><TD>");// 表格头    // 共几条    info.append("共").append(webPagination.getTotalSize()).append("条 ");    // 分几页    info.append("分").append(webPagination.getTotalPage()).append("页 ");    // 第几页    info.append("第");    setCurrPageToSelect(info, webPagination);    info.append("页 ");    // 首页和上一页    setPreviousPageLink(info, webPagination);    // 末页下一页    setLastPageLink(info, webPagination);    // 每页几条，如果没有设置参数名称，采用默认的：    info.append("每页<INPUT size='2' id='").append(webPagination.getPageSizeParamName()).append("' name='")    .append(webPagination.getPageSizeParamName()).append("' value='").append(webPagination.getPageSize()).append("'>条");    // 添加GO按钮    info.append("&nbsp;<INPUT TYPE='button' value='GO' onclick=\"var pageSize=document.getElementById('")    .append(webPagination.getPageSizeParamName()).append("').value;submitFormByName(").append(webPagination.getFormName()).append(",").append(    webPagination.getCurrentPage()).append(",").append("pageSize);\" />");    //        info.append("&nbsp;<INPUT TYPE='submit' value='Go'>");    // 将url参数转化为<input type="hidden" name="name1" value="value1">的方式放在客户端    toHiddenInput(info, webPagination);    info.append("</TD></TR></TABLE>"); // 表格尾    if (webPagination.isPrintScript()) { // 添加脚本      info.append(getScriptString(webPagination));      //            info.append(doGo(webPagination));    }    return info.toString();  }  public String getScriptString(WebPagination webPagination) {    String func = "<SCRIPT>" + "function submitFormByName(form,iPage,pageSize)" + "{" +    "form = eval(form) || document.getElementById(form);"    + "if(!form." + webPagination.getCurrentPageParamName()    + "){var inp = document.createElement('input');inp.setAttribute('type','hidden'); inp.setAttribute('name','"    + webPagination.getCurrentPageParamName() + "');inp.setAttribute('value',iPage); form.appendChild(inp);}" + "else{form."    + webPagination.getCurrentPageParamName() + ".value=iPage;}"    + "if(!form." + webPagination.getPageSizeParamName()    + "){var inp = document.createElement('input');inp.setAttribute('type','hidden'); inp.setAttribute('name','"    + webPagination.getPageSizeParamName() + "');inp.setAttribute('value',pageSize); form.appendChild(inp);}" + "else{form."    + webPagination.getPageSizeParamName() + ".value=pageSize;}"    + "form.submit();" + "return false;" + "}" + "</SCRIPT>";    return func;  }  /**       * 设置首页和前一页       *        * @param sb       */  protected void setPreviousPageLink(StringBuffer sb, WebPagination webPagination) {    if (webPagination.hasPreviousPage()) {      //	    sb.append("<A href=\"javascript:submitFormByName('").append(webPagination.getFormName()).append("',1)\">首页</A>&nbsp;");      sb.append("<A href=\"#\" onclick=\"var pageSize=document.getElementById('").append(webPagination.getPageSizeParamName()).append(      "').value;submitFormByName(").append(webPagination.getFormName()).append(",").append("1").append(",").append("pageSize);\">首页</A>&nbsp;");      sb.append("<A href=\"#\" onclick=\"var pageSize=document.getElementById('").append(webPagination.getPageSizeParamName()).append(      "').value;submitFormByName(").append(webPagination.getFormName()).append(",").append(webPagination.getPreviousPage()).append(",").append(      "pageSize);\">前一页</A>&nbsp;");      //		sb.append("<A href=\"javascript:submitFormByName('").append(webPagination.getFormName()).append("',").append(webPagination.getPreviousPage()).append(")\">前一页</A>&nbsp;");    } else {      sb.append("首页 前一页&nbsp;");    }  }  protected void setLastPageLink(StringBuffer sb, WebPagination webPagination) {    if (webPagination.hasNextPage()) {      sb.append("<A href=\"#\" onclick=\"var pageSize=document.getElementById('").append(webPagination.getPageSizeParamName()).append(      "').value;submitFormByName(").append(webPagination.getFormName()).append(",").append(webPagination.getNextPage()).append(",").append(      "pageSize);\">下一页</A>&nbsp;");      sb.append("<A href=\"#\" onclick=\"var pageSize=document.getElementById('").append(webPagination.getPageSizeParamName()).append(      "').value;submitFormByName(").append(webPagination.getFormName()).append(",").append(webPagination.getTotalPage()).append(",").append(      "pageSize);\">末页</A>&nbsp;");      //	      /*sb.append("<A href=\"javascript:submitFormByName('").append(webPagination.getFormName()).append("',").append(webPagination.getNextPage()).append(")\">下一页</A>&nbsp;");      sb.append("<A href=\"javascript:submitFormByName('").append(webPagination.getFormName()).append("',").append(webPagination.getTotalPage()).append(")\">末页</A>&nbsp;");//      */} else {      sb.append("下一页 末页&nbsp;");    }  }  /* protected String doGo(WebPagination webPagination) {   	String func = "<SCRIPT>" + "function submitFormByName(form,iPage,pageSize)" +  "{" +       "form = eval(form) || document.getElementById(form);"        +"if(!form."+webPagination.getCurrentPageParamName()+"){var inp = document.createElement('input');inp.setAttribute('type','hidden'); inp.setAttribute('name','"+webPagination.getCurrentPageParamName()+"');inp.setAttribute('value',iPage); form.appendChild(inp);}"       +"form.setAttribute('" + webPagination.getCurrentPageParamName() + "',iPage);"       +"if(!form."+webPagination.getPageSizeParamName()+"){var inp = document.createElement('input');inp.setAttribute('type','hidden'); inp.setAttribute('name','"+webPagination.getPageSizeParamName()+"');inp.setAttribute('value',pageSize); form.appendChild(inp);}"       +"form.setAttribute('" + webPagination.getPageSizeParamName() + "',pageSize);"       + "form.submit();" + "return false;" + "}" + "</SCRIPT>";   	return func;       }*/  /**       * 设置当前页选择框       *        * @param sb       */  protected void setCurrPageToSelect(StringBuffer sb, WebPagination webPagination) {    // 生成select    sb.append("<SELECT name='").append(webPagination.getCurrentPageParamName()).append("' onchange=\"var pageSize=document.getElementById('").append(    webPagination.getPageSizeParamName()).append("').value;submitFormByName('").append(webPagination.getFormName()).append(    "',this.value,pageSize)\">");    // sb.append("<SELECT name=\"").append(paramName).append("\">");//    // onchange不需要查询    // 循环生成 option    int total = webPagination.getTotalPage();    if (total < 2) {      sb.append("<option value='1'>1</option>");    } else {      for (int i = 0; i < total; i++) {        if (i == webPagination.getCurrentPage() - 1) {          sb.append("<option selected value='").append(i + 1).append("'>").append(i + 1).append("</option>");        } else {          sb.append("<option value='").append(i + 1).append("'>").append(i + 1).append("</option>");        }      }    }    sb.append("</SELECT>");  }  protected void toHiddenInput(StringBuffer sb, WebPagination webPagination) {    String key = null;    String value = null;    Set set = webPagination.getParameters().keySet();    Iterator it = set.iterator();    while (it.hasNext()) {      key = (String) it.next();      value = (String) webPagination.getParameters().get(key);      sb.append("<INPUT type=\"hidden\" name=\"").append(key).append("\" value=\"").append(value).append("\">");      key = null;      value = null;    }  }}