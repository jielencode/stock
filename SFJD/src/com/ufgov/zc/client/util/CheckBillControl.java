package com.ufgov.zc.client.util;import java.util.ArrayList;import java.util.Date;import java.util.HashMap;import java.util.List;import java.util.Map;import com.ufgov.zc.client.common.ServiceFactory;import com.ufgov.zc.client.common.WorkEnv;import com.ufgov.zc.common.commonbiz.publish.IBaseDataServiceDelegate;import com.ufgov.zc.common.system.RequestMeta;import com.ufgov.zc.common.system.dto.ElementConditionDto;public class CheckBillControl {  private static IBaseDataServiceDelegate baseDataServiceDelegate = (IBaseDataServiceDelegate) ServiceFactory  .create(IBaseDataServiceDelegate.class, "baseDataServiceDelegate");  private Map dzDateMap = new HashMap();  private Map dzResultMap = new HashMap();  private List dzMonthList = new ArrayList();  private int curMonth;  public CheckBillControl(ElementConditionDto elementConditionDto) {    RequestMeta requestMeta = WorkEnv.getInstance().getRequestMeta();    curMonth = WorkEnv.getInstance().getTransMonth();    dzDateMap = baseDataServiceDelegate.getDzDateMap(elementConditionDto, requestMeta);    dzResultMap = baseDataServiceDelegate.getDzResultMap(elementConditionDto, requestMeta);    dzMonthList = baseDataServiceDelegate.getDzMonth(elementConditionDto, requestMeta);  }  public String isPermitDo() {    if (curMonth == 1) {      return null;    }    return checkProcess();  }  private String checkProcess() {    String retStr = null;    Integer month;    Date transDate = WorkEnv.getInstance().getTransDate();    for (int i = 0; i < dzMonthList.size(); i++) {      month = (Integer) dzMonthList.get(i);      if (dzDateMap.containsKey(month) && month < curMonth) {        if (transDate.compareTo((Date) dzDateMap.get(month)) == -1) {          continue; //该月没有到对账时间        }        if (dzResultMap.containsKey(month)) {          if ("对账错误".equals(dzResultMap.get(month))) {            retStr = month + "月份对账错误！\n";            break;          } else if ("对账正确".equals(dzResultMap.get(month))) {            retStr = null;          }        } else {          retStr = month + "月份还没有对账！\n";          break;        }      }    }    return retStr;  }  public static void main(String[] args) {    ElementConditionDto elementConditionDto = new ElementConditionDto();    elementConditionDto.setNd(WorkEnv.getInstance().getTransNd());    elementConditionDto.setCoCode(WorkEnv.getInstance().getCurrCoCode());    elementConditionDto.setTableName("CP_VOUCHER");    elementConditionDto.setPaytypeCode("0202");    new CheckBillControl(elementConditionDto).isPermitDo();  }}