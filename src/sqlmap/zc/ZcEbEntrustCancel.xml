<?xml version="1.0" encoding="UTF-8" ?><!DOCTYPE sqlMap          PUBLIC "-//ibatis.apache.org//DTD SQL Map 2.0//EN"          "http://ibatis.apache.org/dtd/sql-map-2.dtd"><sqlMap namespace="ZcEbEntrustCancel">	<typeAlias alias="ZcEbEntrustCancel" type="com.ufgov.zc.common.zc.model.ZcEbEntrustCancel" />	<typeAlias alias="ZcEbEntrustCancelDetail"		type="com.ufgov.zc.common.zc.model.ZcEbEntrustCancelDetail" />	<typeAlias alias="elementCondition"		type="com.ufgov.zc.common.system.dto.ElementConditionDto" />	<resultMap id="ZcEbEntrustCancelResult" class="ZcEbEntrustCancel">		<result property="entrustCancelId" column="ENTRUST_CANCEL_ID" />		<result property="sn" column="SN" />		<result property="zcMakeCode" column="ZC_MAKE_CODE" />		<result property="zcMakeName" column="ZC_MAKE_NAME" />		<result property="coCode" column="CO_CODE" />		<result property="coName" column="CO_NAME" />		<result property="nd" column="ND" />		<result property="zcMakeLinkman" column="ZC_MAKE_LINKMAN" />		<result property="zcMakeTel" column="ZC_MAKE_TEL" />		<result property="status" column="STATUS" />		<result property="zcInputCode" column="ZC_INPUT_CODE" />		<result property="zcInputDate" column="ZC_INPUT_DATE" />		<result property="zcMoneyBiSum" column="ZC_MONEY_BI_SUM" />		<result property="remark" column="REMARK" />		<result property="processInstId" column="PROCESS_INST_ID" />		<result property="agency" column="AGENCY" />		<result property="zcPifuCgfs" column="ZC_PIFU_CGFS" />		<result property="agencyName" column="AGENCY_NAME" />		<result property="zcDiyuDaima" column="ZC_DIYU_DAIMA" />		<result property="zcWeitoDate" column="ZC_WEITO_DATE" />		<result property="executeDate" column="EXECUTE_DATE" />		<result property="projDocMan" column="PROJ_DOC_MAN" />		<result property="projBidMan" column="PROJ_BID_MAN" />		<result property="orgCode" column="ORG_CODE" />				<result property="snCode" column="SN_CODE" />				<result property="packNum" column="pack_Num" />	</resultMap>	<resultMap id="ZcEbEntrustCancelBaseResult" class="ZcEbEntrustCancel">		<result property="entrustCancelId" column="ENTRUST_CANCEL_ID" />		<result property="sn" column="SN" />		<result property="coCode" column="CO_CODE" />		<result property="nd" column="ND" />		<result property="status" column="STATUS" />		<result property="zcInputCode" column="ZC_INPUT_CODE" />		<result property="zcInputDate" column="ZC_INPUT_DATE" />		<result property="remark" column="REMARK" />		<result property="processInstId" column="PROCESS_INST_ID" />		<result property="agency" column="AGENCY" />		<result property="agencyName" column="AGENCY_NAME" />		<result property="orgCode" column="ORG_CODE" />				<result property="snCode" column="SN_CODE" />		<result property="zcDiyuDaima" column="ZC_DIYU_DAIMA" />	</resultMap>	<resultMap id="ZcEbEntrustCancelDetailResult" class="ZcEbEntrustCancelDetail">		<result property="entrustCancelId" column="ENTRUST_CANCEL_ID" />		<result property="packSum" column="Pack_Sum" />		<result property="packDesc" column="pack_desc" />		<result property="packCode" column="pack_Code" />		<result property="packName" column="pack_Name" />	</resultMap>	<resultMap id="ZcEbEntrustCancelDetailBaseResult" class="ZcEbEntrustCancelDetail">		<result property="entrustCancelId" column="ENTRUST_CANCEL_ID" />		<result property="packCode" column="pack_Code" />	</resultMap>		<select id="getZcEbEntrustCancel" resultMap="ZcEbEntrustCancelResult"		parameterClass="elementCondition">select * from (	select c.entrust_cancel_id,       c.sn,       c.co_code,       co.CO_NAME,       c.nd,       c.status,       c.zc_input_code,       c.zc_input_date,       c.remark,       c.process_inst_id,       c.agency,       c.agency_name,       c.org_code,       c.executor,       c.sn_code,       c.zc_diyu_daima,       e.zc_make_code,       e.zc_make_name,       e.zc_make_linkman,       e.zc_make_tel,       e.zc_money_bi_sum,       e.zc_pifu_cgfs,       e.zc_weito_date,       e.execute_date,       s.superintendent_name PROJ_DOC_MAN,       s.attn_name PROJ_BID_MAN,       0 pack_Num  from zc_eb_entrust_cancel c,zc_eb_entrust e,zc_eb_duty_audit_sheet s,ma_company co  where c.sn=e.sn  and e.sn_code=s.sn_code(+)  and e.sn=s.sn(+)  and c.co_code=co.co_code		<isNotEqual prepend="AND" compareValue="0" property="nd">			c.ND=#nd:INTEGER#		</isNotEqual>		<isNotNull prepend="and" property="status">			<isEqual property="status" compareValue="todo">				exists (select instance_id from V_WF_CURRENT_TASK_ZC_TODO where executor				=#executor# and instance_id = c.process_inst_id)			</isEqual>			<isEqual property="status" compareValue="untread">				exists (select instance_id from V_WF_CURRENT_TASK_ZC_UNTREAD where				executor =#executor# and instance_id = c.process_inst_id)			</isEqual>			<isEqual property="status" compareValue="done">				exists (select instance_id from V_WF_ACTION_HISTORY_GK53 where executor =				#executor# and instance_id = c.process_inst_id)				and c.status!='cancel'				and c.status!='exec'			</isEqual>			<isEqual property="status" compareValue="exec">				(c.status ='exec')			</isEqual>			<isEqual property="status" compareValue="draft">				exists (select WF_DRAFT_NAME from as_wf_draft where user_id=#executor# and				compo_id=#wfcompoId# and WF_DRAFT_ID=c.process_inst_id)			</isEqual>		</isNotNull>		<isNotNull prepend="and" property="coCode">			c.CO_CODE=#coCode:VARCHAR#		</isNotNull>		<include refid="BusiNumLim.BusiNumLimStr" />		) t where 1=1<isEqual prepend="and" property="status" compareValue="all">			process_inst_id &gt; 0</isEqual>		order by ZC_INPUT_DATE desc	</select>	<select id="getZcEbEntrustForCancel" resultMap="ZcEbEntrustCancelResult" parameterClass="elementCondition">select '' entrust_cancel_id,       e.sn,       e.co_code,       '' CO_NAME,       e.nd,       e.status,       e.zc_input_code,       e.zc_input_date,       e.remark,       e.process_inst_id,       e.agency,       e.agency_name,       nvl(s.superintendent_org,e.org_code) org_code,       e.executor,       e.sn_code,       e.zc_diyu_daima,       e.zc_make_code,       e.zc_make_name,       e.zc_make_linkman,       e.zc_make_tel,       e.zc_money_bi_sum,       e.zc_pifu_cgfs,       e.zc_weito_date,       e.execute_date,       s.superintendent_name PROJ_DOC_MAN,       s.attn_name PROJ_BID_MAN,       (select count(*) from zc_eb_req_pack p where p.entrust_code=e.sn and status != 'cancel') pack_Num  from zc_eb_entrust e,zc_eb_duty_audit_sheet s  where 1=1	<isNotEqual prepend="AND" compareValue="0" property="nd">		e.ND=#nd:INTEGER#	</isNotEqual>	<isNotNull prepend="and" property="coCode">		e.CO_CODE=#coCode:VARCHAR#	</isNotNull>  and e.sn_code=s.sn_code(+)  and e.sn=s.sn(+)  and e.status!='cancel'	</select>	<select id="getZcEbEntrustCancelByKey"  resultMap="ZcEbEntrustCancelResult" parameterClass="String">select c.entrust_cancel_id,       c.sn,       c.co_code,       '' CO_NAME,       c.nd,       c.status,       c.zc_input_code,       c.zc_input_date,       c.remark,       c.process_inst_id,       c.agency,       c.agency_name,       c.org_code,       c.executor,       c.sn_code,       c.zc_diyu_daima,       e.zc_make_code,       e.zc_make_name,       e.zc_make_linkman,       e.zc_make_tel,       e.zc_money_bi_sum,       e.zc_pifu_cgfs,       e.zc_weito_date,       e.execute_date,       s.superintendent_name PROJ_DOC_MAN,       s.attn_name PROJ_BID_MAN,       (select count(*) from zc_eb_req_pack p where p.entrust_code=e.sn and status != 'cancel') pack_Num  from zc_eb_entrust_cancel c,zc_eb_entrust e,zc_eb_duty_audit_sheet s  where c.entrust_cancel_id=#value#  and c.sn=e.sn  and e.sn_code=s.sn_code(+)  and e.sn=s.sn(+)	</select>	<update id="updateZcEbEntrustCancel" parameterClass="ZcEbEntrustCancel">		update		ZC_EB_ENTRUST_CANCEL		set		SN=#sn:VARCHAR#,		CO_CODE=#coCode:VARCHAR#,		ND=#nd:VARCHAR#,		STATUS=#status:VARCHAR#,		ZC_INPUT_CODE=#zcInputCode:VARCHAR#,		ZC_INPUT_DATE=#zcInputDate:DATE#,		REMARK=#remark:VARCHAR#,		AGENCY=#agency:VARCHAR#,		AGENCY_NAME=#agencyName:VARCHAR#,		ZC_DIYU_DAIMA=#zcDiyuDaima:VARCHAR#,		ORG_CODE=#orgCode:VARCHAR#,		SN_CODE=#snCode:VARCHAR#		where		ENTRUST_CANCEL_ID=#entrustCancelId:VARCHAR#	</update>	<delete id="deleteByKey" parameterClass="string">		delete from ZC_EB_ENTRUST_CANCEL where ENTRUST_CANCEL_ID = #value#	</delete>	<insert id="insertZcEbEntrustCancel" parameterClass="ZcEbEntrustCancel">		insert into		ZC_EB_ENTRUST_CANCEL		(ENTRUST_CANCEL_ID,		sn,		CO_CODE,		ND,		status,		zc_input_code,		zc_input_date,		remark,		process_inst_id,		AGENCY,		AGENCY_NAME,		zc_diyu_daima,		ORG_CODE,		SN_CODE)		values		(#entrustCancelId:VARCHAR#,		#sn:VARCHAR#,		#coCode:VARCHAR#,		#nd:VARCHAR#,		#status:VARCHAR#,		#zcInputCode:VARCHAR#,		#zcInputDate:DATE#,		#remark:VARCHAR#,		#processInstId:DECIMAL#,		#agency:VARCHAR#,		(select zc_b_agency.zc_agey_name from ZC_B_AGENCY zc_b_agency where		zc_b_agency.zc_agey_code=#agency:VARCHAR#),		#zcDiyuDaima:VARCHAR#,		#orgCode:VARCHAR#,		#snCode:VARCHAR#)	</insert>	<select id="selectDetailForCancel"  parameterClass="elementCondition" resultMap="ZcEbEntrustCancelDetailResult">	select '' entrust_cancel_id,       p.pack_code,       p.pack_name,       p.pack_budget Pack_Sum,       p.pack_desc  from zc_eb_req_pack  p where  p.entrust_code=#zcMakeCode#	<isNotNull prepend="and" property="zcText0">  p.pack_code not in ($zcText0$)	</isNotNull> and p.status!='cancel' and not exists (select pack_code from zc_eb_entrust_cancel_pack c where c.pack_code=p.pack_code) and not exists (select pack_code from zc_eb_eval_report r where r.pack_code=p.pack_code and r.provider_code is not null)	</select>	<select id="selectDetailByKey"  parameterClass="string" resultMap="ZcEbEntrustCancelDetailResult">	select d.entrust_cancel_id,       d.pack_code,       p.pack_name,       p.pack_budget Pack_Sum,       p.pack_desc  from zc_eb_entrust_cancel_pack d, zc_eb_req_pack p where d.entrust_cancel_id = #value#   and d.pack_code = p.pack_code	</select>	<delete id="deleteDetailByKey" parameterClass="string">		delete from ZC_EB_ENTRUST_CANCEL_PACK where ENTRUST_CANCEL_ID = #value#	</delete>	<insert id="insertZcEbEntrustCancelDetail" parameterClass="ZcEbEntrustCancelDetail">		insert into		ZC_EB_ENTRUST_CANCEL_PACK		(ENTRUST_CANCEL_ID,		pack_code)		values		(#entrustCancelId:VARCHAR#,		#packCode:VARCHAR#)	</insert>	<select id="selectProjIsAllCancel"  parameterClass="java.util.Map" resultClass="Integer">	select count(*) from zc_eb_pack where STATUS != 'cancel' and proj_code=#projCode# and pack_code not in (select pack_code from zc_eb_entrust_cancel_pack where ENTRUST_CANCEL_ID=#cancelId#)	</select>		<select id="getZcEbBulletinBidForCancel" resultClass="String"		parameterClass="String">		select pack_name from zc_eb_notice where pack_code in ($value$)		union		select p.pack_name from zc_xmcg_ht h,zc_eb_req_pack p where p.pack_code in ($value$) and p.pack_code=h.zc_bid_code	</select>	<select id="getExpmainData" resultMap="ZcEbEntrustCancelBaseResult" parameterClass="String">	select c.* from zc_eb_entrust_cancel c where c.entrust_cancel_id in ($value$)	</select>	<select id="getExpItemData" resultMap="ZcEbEntrustCancelDetailBaseResult" parameterClass="String">	select * from ZC_EB_ENTRUST_CANCEL_PACK where entrust_cancel_id = #value#	</select>	<select id="getProjCodeByPackCode" resultClass="String" parameterClass="String">	select p.proj_code from zc_eb_proj p, zc_eb_pack pk where pack_code=#value# and p.proj_code=pk.proj_code order by p.proj_date desc,p.proj_code desc	</select>	<select id="selectCancelDataByKey" resultMap="ZcEbEntrustCancelBaseResult" parameterClass="String">	select c.* from zc_eb_entrust_cancel c where c.entrust_cancel_id = #value#	</select></sqlMap>