<?xml version="1.0" encoding="UTF-8" ?><!DOCTYPE sqlMap          PUBLIC "-//ibatis.apache.org//DTD SQL Map 2.0//EN"          "http://ibatis.apache.org/dtd/sql-map-2.dtd"><sqlMap namespace="ZcEbGuiDang">	<typeAlias alias="elementCondition"		type="com.ufgov.zc.common.system.dto.ElementConditionDto" />	<typeAlias alias="ZcEbGuiDangBill"		type="com.ufgov.zc.common.zc.model.ZcEbGuiDangBill" />	<typeAlias alias="ZcEbGuiDangItem"		type="com.ufgov.zc.common.zc.model.ZcEbGuiDangItem" />	<typeAlias alias="ZcEbProj" type="com.ufgov.zc.common.zc.model.ZcEbProj" />	<typeAlias alias="ZcEbAuditSheet"		type="com.ufgov.zc.common.zc.model.ZcEbAuditSheet" />	<resultMap id="ZcEbGuiDangBillResult" class="ZcEbGuiDangBill">		<result property="guiDangId" column="GUIDANG_ID" />		<result property="coName" column="CO_NAME" />		<result property="coCode" column="CO_CODE" />		<result property="projCode" column="PROJ_CODE" />		<result property="projName" column="PROJ_NAME" />		<result property="sheetId" column="SHEET_ID" />		<result property="zcMoneyBiSum" column="ZC_MONEY_BI_SUM" />		<result property="zcPifuCgfs" column="ZC_PIFU_CGFS" />		<result property="executeDate" column="EXECUTE_DATE" />		<result property="executor" column="EXECUTOR" />		<result property="executorName" column="EXECUTOR_NAME" />		<result property="orgCode" column="ORG_CODE" />		<result property="agency" column="AGENCY" />		<result property="status" column="STATUS" />		<result property="nd" column="ND" />		<result column="PROCESS_INST_ID" jdbcType="DECIMAL" property="processInstId" />		<result property="isGoonAudit" column="IS_GOON_AUDIT" />	</resultMap>	<resultMap id="ZcEbGuiDangItemResult" class="ZcEbGuiDangItem">		<result property="guiDangId" column="GUIDANG_ID" />		<result property="name" column="NAME" />		<result property="num" column="NUM" />		<result property="type" column="TYPE" />        <result property="keyStr" column="KEY_STR" />		<result property="pageNum" column="PAGE_NUM" />		<result property="bookNum" column="BOOK_NUM" />		<result property="bookNo" column="BOOK_NO" />		<result property="splitBoxNo" column="SPLIT_BOX_NO" />		<result property="keyStr" column="KEY_STR" />	</resultMap>	<resultMap id="rltMapping" class="ZcEbAuditSheet">		<result property="sheetId" column="SHEET_ID" />		<result property="sn" column="SN" />		<result property="executor" column="EXECUTOR" />		<result property="executeDate" column="EXECUTE_DATE" />		<result property="superintendentOrg" column="SUPERINTENDENT_ORG" />		<result property="superintendent" column="SUPERINTENDENT" />		<result property="superintendentName" column="SUPERINTENDENT_NAME" />		<result property="zcIsZrsh" column="ZC_IS_ZRSH" />		<result property="zcFzrUserId" column="ZC_FZR_USER_ID" />		<result property="zcFzrUserName" column="ZC_FZR_USER_NAME" />		<result property="zcEbEntrust.zcMakeCode" column="ZC_MAKE_CODE" />		<result property="zcEbEntrust.zcMakeName" column="ZC_MAKE_NAME" />		<result property="zcEbEntrust.snCode" column="SN_code" />		<result property="zcEbEntrust.coCode" column="CO_CODE" />		<result property="zcEbEntrust.zcMakeLinkman" column="ZC_MAKE_LINKMAN" />		<result property="zcEbEntrust.zcMakeTel" column="ZC_MAKE_TEL" />		<result property="zcEbEntrust.zcMoneyBiSum" column="ZC_MONEY_BI_SUM" />		<result property="zcEbEntrust.agency" column="AGENCY" />		<result property="zcEbEntrust.zcPifuCgfs" column="ZC_ENTRUST_PIFU_CGFS" />		<result property="zcEbEntrust.agencyName" column="AGENCY_NAME" />	</resultMap>	<!-- list页面数据 -->	<select id="getZcEbGuiDangBillList" resultMap="ZcEbGuiDangBillResult"		parameterClass="elementCondition">		select * from ZC_EB_GUIDANG_BILL ZC_EB_GUIDANG_BILL		where		ZC_EB_GUIDANG_BILL.ND = #nd#		<include refid="BusiNumLim.BusiNumLimStr" />		<isNotNull prepend="AND" property="status">			<isEqual property="status" compareValue="todo">				exists (select instance_id from V_WF_CURRENT_TASK_ZC_TODO where executor =#executor# and instance_id = ZC_EB_GUIDANG_BILL.process_inst_id)			</isEqual>			<isEqual property="status" compareValue="untread">				exists ( select instance_id from V_WF_CURRENT_TASK_ZC_UNTREAD where executor =#executor# and instance_id = ZC_EB_GUIDANG_BILL.process_inst_id)			</isEqual>			<isEqual property="status" compareValue="accepted">				status='save'			</isEqual>			<isEqual property="status" compareValue="exec">				status='exec'			</isEqual>			<isEqual property="status" compareValue="done">				exists (select				instance_id from V_WF_ACTION_HISTORY_GK53 where executor =				#executor# and instance_id = ZC_EB_GUIDANG_BILL.process_inst_id)and				status!='back' and				status!='exec'				</isEqual>			<isEqual property="status" compareValue="draft">				exists (select				WF_DRAFT_NAME from as_wf_draft where user_id=#executor# and				compo_id=#wfcompoId# and WF_DRAFT_ID=ZC_EB_GUIDANG_BILL.process_inst_id)			</isEqual>			<isEqual property="status" compareValue="all">				1=1			</isEqual>		</isNotNull>		<isNotNull prepend="AND" property="projCode">			ZC_EB_GUIDANG_BILL.PROJ_CODE			=#projCode:VARCHAR#		 </isNotNull>		 ORDER BY EXECUTE_DATE DESC	</select>	<!-- 通过主键查询验收单 -->	<select id="getZcEbGuiDongBillById" resultMap="ZcEbGuiDangBillResult"		parameterClass="string">		select		*		from		ZC_EB_GUIDANG_BILL master		where		master.GUIDANG_ID=#guiDangId#	</select>	<!-- 编辑页面子表数据 -->	<select id="getZcEbGuiDangItemList" resultMap="ZcEbGuiDangItemResult"		parameterClass="string">		select		*		from		ZC_EB_GUIDANG_ITEM master		where		master.GUIDANG_ID = #guiDangId#	</select>	<!-- 保存主表数据 -->	<insert id="insertEbGuiDangBill" parameterClass="ZcEbGuiDangBill">		insert into		ZC_EB_GUIDANG_BILL		(GUIDANG_ID,CO_NAME,CO_CODE,PROJ_CODE,PROJ_NAME,SHEET_ID,ZC_MONEY_BI_SUM,ZC_PIFU_CGFS,		EXECUTE_DATE,EXECUTOR,EXECUTOR_NAME,ORG_CODE,STATUS,PROCESS_INST_ID,ND,AGENCY,IS_GOON_AUDIT)		values		(#guiDangId#,#coName#,#coCode#, #projCode#, #projName#,		#sheetId#,#zcMoneyBiSum#,#zcPifuCgfs#, #executeDate#,		#executor#,#executorName#,#orgCode#,#status#,#processInstId#,#nd#,#agency#,#isGoonAudit#)	</insert>	<!-- 保存子表数据 -->	<insert id="insertZcEbGuiDangItem" parameterClass="ZcEbGuiDangItem">		insert		into		ZC_EB_GUIDANG_ITEM		(NAME,NUM,KEY_STR,TYPE,GUIDANG_ID,PAGE_NUM,BOOK_NUM,BOOK_NO,SPLIT_BOX_NO)		values		(#name#,#num#,#keyStr#,#type#,#guiDangId#,#pageNum#,#bookNum#,#bookNo#,#splitBoxNo#)	</insert>	<update id="updateEbGuiDangBill" parameterClass="ZcEbGuiDangBill">		update		ZC_EB_GUIDANG_BILL		set		CO_CODE=#coCode:VARCHAR#,		CO_NAME=#coName:VARCHAR#,		PROJ_CODE=#projCode:VARCHAR#,		PROJ_NAME=#projName:VARCHAR#,		SHEET_ID=#sheetId:VARCHAR#,		ZC_MONEY_BI_SUM=#zcMoneyBiSum:VARCHAR#,		ZC_PIFU_CGFS=#zcPifuCgfs:VARCHAR#,		EXECUTE_DATE=#executeDate:DATE#,		EXECUTOR=#executor:VARCHAR#,		EXECUTOR_NAME=#executorName:VARCHAR#,		ORG_CODE=#orgCode:VARCHAR#,		STATUS=#status:VARCHAR#,		ND=#nd:VARCHAR#,		PROCESS_INST_ID=#processInstId#,		AGENCY=#agency#,		IS_GOON_AUDIT=#isGoonAudit#		where		GUIDANG_ID=		#guiDangId#	</update>	<delete id="deleteZcEbGuiDangBillById" parameterClass="string">		delete		from		ZC_EB_GUIDANG_BILL		where GUIDANG_ID = #guiDangId#    </delete>	<delete id="deleteZcEbGuiDangItemByGuiDangId" parameterClass="string">		delete		from		ZC_EB_GUIDANG_ITEM		where GUIDANG_ID = #guiDangId#    </delete>	<select id="selectSheetList" resultMap="rltMapping"		parameterClass="elementCondition">		select		distinct master.*,		E.SN,		e.sn_code,		E.ZC_MAKE_CODE,		E.ZC_MAKE_NAME,		E.CO_CODE,		E.ND,		E.ZC_MAKE_LINKMAN,		E.ZC_MAKE_TEL,		E.STATUS as ENTRUST_STATUS,		E.EXECUTOR as ZC_ENTRUST_INPUT_CODE,		E.EXECUTE_DATE as ZC_ENTRUST_INPUT_DATE,		E.ZC_MONEY_BI_SUM,		E.AGENCY,		E.ZC_PIFU_CGFS as ZC_ENTRUST_PIFU_CGFS,		E.AGENCY_NAME,		E.ORG_CODE		FROM		ZC_EB_DUTY_AUDIT_SHEET master,		ZC_EB_ENTRUST E		WHERE master.SN = E.SN    and master.status='exec'		AND not exists (		select PROJ_CODE from Zc_Eb_Guidang_Bill where PROJ_CODE=e.SN_CODE		)		and master.attn=#zcText0#	</select></sqlMap>