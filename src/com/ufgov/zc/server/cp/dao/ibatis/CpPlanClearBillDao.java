package com.ufgov.zc.server.cp.dao.ibatis;import java.sql.SQLException;import java.util.HashMap;import java.util.List;import java.util.Map;import org.springframework.orm.ibatis.SqlMapClientCallback;import org.springframework.orm.ibatis.support.SqlMapClientDaoSupport;import com.ibatis.sqlmap.client.SqlMapExecutor;import com.ufgov.zc.common.cp.model.CpPlanClearBill;import com.ufgov.zc.common.system.constants.NumLimConstants;import com.ufgov.zc.common.system.dto.ElementConditionDto;import com.ufgov.zc.common.system.exception.DaoException;import com.ufgov.zc.server.cp.dao.ICpPlanClearBillDao;import com.ufgov.zc.server.system.util.NumLimUtil;public class CpPlanClearBillDao extends SqlMapClientDaoSupport implements ICpPlanClearBillDao {  public List getCpPlanClearBill(ElementConditionDto elementDto) {    Map map = new HashMap();    map.put("nd", new Integer(elementDto.getNd()));    map.put("startDate", elementDto.getStartDate());    map.put("endDate", elementDto.getEndDate());    map.put("status", elementDto.getStatus());    map.put("bankCode", elementDto.getBankCode());    map.put("printTimes", elementDto.getPrintTimes());    map.put("fundCode", elementDto.getFundCode());    map.put("coCodeFilter", elementDto.getCoCodeFilter());    map.put("paytypeCode", elementDto.getPaytypeCode());    map.put("billType", elementDto.getBillType());    if (elementDto.getNumLimCompoId() != null) {//      String numLimitStr = NumLimUtil.getInstance().getNumLimCondByCoType(elementDto.getNumLimCompoId(),////      NumLimConstants.FWATCH);////      map.put("numLimitStr", numLimitStr);    }    return this.getSqlMapClientTemplate().queryForList("CpPlanClearBill.getCpPlanClearBill", map);  }  public void increasePrintTimes(List planClearBillIdList) {    Map map = new HashMap();    if (planClearBillIdList.size() == 0) {      throw new DaoException("increasePrintTimes的参数planClearBillIdList为空");    }    map.put("planClearBillIdList", planClearBillIdList);    this.getSqlMapClientTemplate().update("CpPlanClearBill.increasePrintTimes", map);  }  public void insertCpPlanClearBills(final List cpPlanClearBills) {    this.getSqlMapClientTemplate().execute(new SqlMapClientCallback() {      public Object doInSqlMapClient(SqlMapExecutor executor) throws SQLException {        executor.startBatch();        for (int i = 0; i < cpPlanClearBills.size(); i++) {          executor.insert("CpPlanClearBill.insertCpPlanClearBill", cpPlanClearBills.get(i));        }        executor.executeBatch();        return null;      }    });  }  public String sendBank(List cpPlanBillList, String transtype, String agentType) {    int num = 0;    if (cpPlanBillList.size() == 0) {      throw new DaoException("CpPlanClearBillDao-->sendBank()的参数cpPlanBillList为空");    }    Map map = new HashMap();    map.put("cpPlanClearBillList", cpPlanBillList);    if (transtype.equals("00")) {      num = this.getSqlMapClientTemplate().update("CpPlanClearBill.sendBankForCpPlanClearBill", map);    } else if (transtype.equals("01")) {      num = this.getSqlMapClientTemplate().update("CpPlanClearBill.cancelSendBankForCpPlanClearBill", map);    }    if (cpPlanBillList.size() == num) {      return null;    } else {      throw new DaoException("CpPlanClearBillDao-->sendBank()更新记录不唯一");    }  }  public void deleteCpPlanClearBill(CpPlanClearBill cpPlanClearBill) {    this.getSqlMapClientTemplate().delete("CpPlanClearBill.deleteCpPlanClearBillById", cpPlanClearBill);  }  public void deleteCpPlanClearList(CpPlanClearBill cpPlanClearBill) {    this.getSqlMapClientTemplate().delete("CpPlanClearBill.deleteCpPlanClearListById", cpPlanClearBill);  }  public void deleteCpPlanClearRelation(CpPlanClearBill cpPlanClearBill) {    this.getSqlMapClientTemplate().delete("CpPlanClearBill.deleteCpPlanClearRelationById", cpPlanClearBill);  }  public int updateDpDetailByPlanClearBillIdForDelete(CpPlanClearBill cpPlanClearBill) {    return this.getSqlMapClientTemplate().update("CpPlanClearBill.updateDpDetailByPlanClearBillIdForDel",    cpPlanClearBill);  }}