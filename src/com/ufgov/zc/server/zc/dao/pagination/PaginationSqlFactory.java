/* * 创建日期 2006-3-31 * * TODO 要更改此生成的文件的模板，请转至 * 窗口 － 首选项 － Java － 代码样式 － 代码模板 */package com.ufgov.zc.server.zc.dao.pagination;import org.apache.log4j.Logger;public class PaginationSqlFactory {  private static Logger logger = Logger.getLogger(PaginationSqlFactory.class.getName());  public static final String DB_TYPE_ORACLE = "oracle";  public static final String DB_TYPE_DB2 = "db2";  /* 系统启动时会初始化该属性 */  public static String dbType = "oracle";  /**   * 进行数据库分页查询语句的拼写   * @param sql SQL查询语句   * @param start 查询起始处   * @param end 查询结束处   * @return 支持分页的SQL查询语句，默认值为Oracle数据库类型的分页查询语句。   */  public static String generateSql(String sql, long start, long end) {    if (dbType.equalsIgnoreCase(PaginationSqlFactory.DB_TYPE_ORACLE)) {      return generateOracleSql(sql, start, end);    }    if (dbType.equalsIgnoreCase(PaginationSqlFactory.DB_TYPE_DB2)) {      return generateDB2Sql(sql, start, end);    }    return generateOracleSql(sql, start, end);  }  /**   * 生成ORACLE类型SQL语句    */  private static String generateOracleSql(String sql, long start, long end) {    //拼凑SQL语句    StringBuffer sb = new StringBuffer();    sb.append("select * FROM (SELECT A.*, rownum r FROM (");    sb.append(sql);    sb.append(") A WHERE rownum <= ");    sb.append(end);    sb.append(") B where r >=");    sb.append(start);    //		logger.debug(sb.toString());    return sb.toString();  }  /**   * 生成DB2类型SQL语句    */  private static String generateDB2Sql(String sql, long start, long end) {    return null;  }  //	public static void main(String a[]){  ////	    PaginationSqlFactory.dbType = "dB2";  ////	    String sql = "select ci2.* , nvl(ci1.catalog_name,'根目录') as parent_name from catalog_info ci1 , catalog_info ci2 where ci1.catalog_id(+)=ci2.parent_catalog_id and ci2.delete_flag='1' and ci2.department_id='100888'";  //	    String sql = "select t.name from amytest t union select aas.id from a_audit_stack aas ";  //	    sql = generateSql(sql,1,3);  //	    System.out.println(sql);  //	}}