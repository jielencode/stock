package com.ufgov.zc.server.zc.web.action.xjprint;import java.util.Date;import java.util.List;import javax.servlet.http.HttpServletRequest;import javax.servlet.http.HttpServletResponse;import org.apache.struts.action.Action;import org.apache.struts.action.ActionForm;import org.apache.struts.action.ActionForward;import org.apache.struts.action.ActionMapping;import com.ufgov.zc.common.system.RequestMeta;import com.ufgov.zc.common.system.dto.ElementConditionDto;import com.ufgov.zc.common.zc.model.ZcEbProCompletion;import com.ufgov.zc.server.system.SpringContext;import com.ufgov.zc.server.zc.service.IZcEbProCompletionService;public class ZcEbProCompletionPrintAction extends Action {  public ActionForward execute(ActionMapping mapping, ActionForm form, HttpServletRequest request, HttpServletResponse response) throws Exception {    //    SpringContext.setSpringContext(ApplusContext.getApplicationContext("com.ufgov.app.zc.server"));    IZcEbProCompletionService completionService = (IZcEbProCompletionService) SpringContext.getBean("zcEbProCompletionService");    String code = request.getParameter("code");    code = new String(code.getBytes("ISO8859-1"), "utf-8");    System.out.println("ZcEbProCompletionPrintAction:" + code);    ElementConditionDto condition = new ElementConditionDto();    condition.setZcText1(code);    RequestMeta mt = new RequestMeta();    if (mt.getTransDate() == null) {      mt.setTransDate(new Date());    }    String nd = (String) request.getSession().getAttribute("svNd");    try {      mt.getTransDate().setYear(Integer.parseInt(nd));    } catch (Exception e) {    }    mt.setSvCoCode((String) request.getSession().getAttribute("svCoCode"));    mt.setSvOrgCode((String) request.getSession().getAttribute("svOrgCode"));    mt.setSvPoCode((String) request.getSession().getAttribute("svPoCode"));    mt.setAccountId((String) request.getSession().getAttribute("svAccountId"));    mt.setSvUserID((String) request.getSession().getAttribute("svUserID"));//    mt.setSvRoleId((String) request.getSession().getAttribute("svRoleId"));    List list = completionService.getZcEbProCompletionByCondition(condition, mt);    ZcEbProCompletion comp = null;    if (list == null || list.size() == 0) {      comp = new ZcEbProCompletion();    } else {      comp = (ZcEbProCompletion) list.get(0);    }    request.setAttribute("comp", comp);    return mapping.findForward("success");  }}